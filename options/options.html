<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>URLSweep Configuration</title>
    <link rel="stylesheet" href="options.css" />
  </head>
  <body>
    <div class="container">
      <header class="header">
        <div class="logo-container">
          <h1>URLSweep</h1>
          <span id="version-badge" class="badge"></span>
        </div>
        <p class="subtitle">
          Manage exceptions and customize tracking parameters to block.
        </p>
      </header>

      <main class="main-content">
        <!-- Active Rules Section -->
        <section class="card">
          <header
            class="card-header"
            style="
              display: flex;
              justify-content: space-between;
              align-items: center;
              padding-bottom: 24px;
            "
          >
            <div>
              <h2 style="margin-bottom: 0">Filter Rules</h2>
              <p style="margin-top: 4px">
                Tracking rules are updated daily from upstream.
              </p>
            </div>
            <div style="text-align: right">
              <div
                id="stat-updated"
                style="
                  font-size: 12px;
                  color: var(--text-muted);
                  margin-bottom: 8px;
                "
              >
                Last updated: -
              </div>
              <a
                href="https://rules2.clearurls.xyz/data.minify.json"
                target="_blank"
                class="btn btn-secondary btn-sm"
                style="
                  padding: 6px 12px;
                  font-size: 13px;
                  text-decoration: none;
                "
                >View Source</a
              >
            </div>
          </header>
        </section>

        <!-- Statistics Dashboard Section -->
        <section class="card">
          <header class="card-header">
            <h2>Statistics Dashboard</h2>
            <p>Overview of tracking parameters stripped by URLSweep.</p>
          </header>
          <div class="card-body">
            <!-- Dynamic Progress Bar -->
            <div class="stats-progress-container">
              <div class="stats-progress-track">
                <div
                  class="stats-progress-blocked"
                  id="progress-blocked"
                  style="width: 0%"
                ></div>
                <div
                  class="stats-progress-elements"
                  id="progress-elements"
                  style="width: 100%"
                ></div>
              </div>
            </div>

            <!-- Stats Rows -->
            <div class="stats-list-container">
              <div class="stats-list-row">
                <span class="stats-label">Elements</span>
                <span class="stats-value text-info" id="stat-elements">0</span>
              </div>
              <div class="stats-list-row">
                <span class="stats-label">Blocked</span>
                <span class="stats-value text-danger" id="stat-blocked">0</span>
              </div>
              <div class="stats-list-row">
                <span class="stats-label">Percentage</span>
                <span class="stats-value text-success" id="stat-pct"
                  >0.000%</span
                >
              </div>
            </div>

            <!-- Historical Stats Grid -->
            <div class="stats-grid-legacy" style="margin-top: 24px">
              <div class="stat-box">
                <span class="stat-value" id="stat-total">0</span>
                <span class="stat-label">Total Blocked</span>
              </div>
              <div class="stat-box">
                <span class="stat-value" id="stat-today">0</span>
                <span class="stat-label">Today</span>
              </div>
              <div class="stat-box">
                <span class="stat-value" id="stat-week">0</span>
                <span class="stat-label">Past 7 Days</span>
              </div>
            </div>

            <div style="margin-top: 24px; text-align: center">
              <button id="btn-reset-stats" class="btn btn-danger">
                Reset Statistics
              </button>
            </div>
          </div>
        </section>

        <!-- Allowlist Section -->
        <section class="card">
          <header class="card-header">
            <h2>Website Allowlist</h2>
            <p>
              URLs added here will <strong>not</strong> have their tracking
              parameters removed.
            </p>
          </header>
          <div class="card-body">
            <form id="allowlist-form" class="input-group">
              <input
                type="text"
                id="allowlist-input"
                placeholder="e.g., example.com"
                required
                autocomplete="off"
                spellcheck="false"
              />
              <button type="submit" class="btn btn-primary">Add Domain</button>
            </form>
            <div class="list-container">
              <ul id="allowlist" class="item-list"></ul>
              <p id="allowlist-empty" class="empty-state hidden">
                No domains allowlisted.
              </p>
            </div>
          </div>
        </section>

        <!-- Custom Parameters Section -->
        <section class="card">
          <header class="card-header">
            <h2>Custom Tracker Parameters</h2>
            <p>
              Add custom URL parameters that you want URLSweep to strip from
              every website.
            </p>
          </header>
          <div class="card-body">
            <form id="custom-params-form" class="input-group">
              <textarea
                id="custom-params-input"
                placeholder="Paste parameters here... (e.g. tracker1, tracker2)"
                required
                autocomplete="off"
                spellcheck="false"
                rows="2"
              ></textarea>
              <button type="submit" class="btn btn-primary">
                Add Parameter
              </button>
            </form>
            <div class="list-container">
              <ul id="custom-params-list" class="item-list"></ul>
              <p id="custom-params-empty" class="empty-state hidden">
                No custom parameters added.
              </p>
            </div>
          </div>
        </section>

        <!-- Backup and Restore Section -->
        <section class="card">
          <header class="card-header">
            <h2>Backup & Restore</h2>
            <p>
              Export your allowlist and custom rules to a file, or import from
              an existing backup.
            </p>
          </header>
          <div class="card-body action-group">
            <button id="btn-export" class="btn btn-secondary">
              <svg
                width="16"
                height="16"
                viewBox="0 0 24 24"
                fill="none"
                stroke="currentColor"
                stroke-width="2"
              >
                <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4" />
                <polyline points="7 10 12 15 17 10" />
                <line x1="12" y1="15" x2="12" y2="3" />
              </svg>
              Export Backup
            </button>
            <label for="btn-import" class="btn btn-secondary">
              <svg
                width="16"
                height="16"
                viewBox="0 0 24 24"
                fill="none"
                stroke="currentColor"
                stroke-width="2"
              >
                <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4" />
                <polyline points="17 8 12 3 7 8" />
                <line x1="12" y1="3" x2="12" y2="15" />
              </svg>
              Import Backup
              <input type="file" id="btn-import" accept=".json" hidden />
            </label>
          </div>
        </section>
      </main>

      <footer class="footer">
        <p>URLSweep - Privacy First, Zero Overhead.</p>
      </footer>
    </div>

    <!-- Reset Confirmation Modal -->
    <div id="reset-modal" class="modal-overlay">
      <div class="modal-card">
        <h3>Reset Statistics?</h3>
        <p>
          Are you sure you want to reset all tracking statistics? This action
          cannot be undone and you will lose all historical data.
        </p>
        <div class="modal-actions">
          <button id="btn-modal-cancel" class="btn btn-secondary">
            Cancel
          </button>
          <button id="btn-modal-confirm" class="btn btn-primary">
            Yes, Reset Stats
          </button>
        </div>
      </div>
    </div>

    <template id="list-item-template">
      <li class="list-item">
        <span class="item-text"></span>
        <button
          class="btn-icon btn-delete"
          aria-label="Remove item"
          title="Remove"
        >
          <svg
            width="16"
            height="16"
            viewBox="0 0 24 24"
            fill="none"
            stroke="currentColor"
            stroke-width="2"
            stroke-linecap="round"
            stroke-linejoin="round"
          >
            <line x1="18" y1="6" x2="6" y2="18"></line>
            <line x1="6" y1="6" x2="18" y2="18"></line>
          </svg>
        </button>
      </li>
    </template>

    <script src="options.js"></script>
  </body>
</html>
